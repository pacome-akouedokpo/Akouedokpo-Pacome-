<!doctype html>
<html ⚡ lang="fr">
  <head>
    <meta charset="utf-8">
    <title>Commande de contenu</title>
    <link rel="canonical" href="self.html" />
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
      <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-bind" src="https://cdn.ampproject.org/v0/amp-bind-0.1.js"></script>
    <script async custom-element="amp-form" src="https://cdn.ampproject.org/v0/amp-form-0.1.js"></script>
    <script async custom-element="amp-selector" src="https://cdn.ampproject.org/v0/amp-selector-0.1.js"></script>
    <script async custom-element="amp-geo" src="https://cdn.ampproject.org/v0/amp-geo-0.1.js"></script>
    <script async custom-template="amp-mustache" src="https://cdn.ampproject.org/v0/amp-mustache-0.2.js"></script>
    <style amp-boilerplate>
    body {
      -webkit-animation: -amp-start 8s steps(1,end) 0s 1 normal both;
      -moz-animation: -amp-start 8s steps(1,end) 0s 1 normal both;
      -ms-animation: -amp-start 8s steps(1,end) 0s 1 normal both;
      animation: -amp-start 8s steps(1,end) 0s 1 normal both;
}
    @-webkit-keyframes -amp-start { from { visibility: hidden} to { visibility: visible}}
    @-moz-keyframes -amp-start { from { visibility: hidden} to { visibility: visible}}
    @-ms-keyframes -amp-start { from { visibility: hidden} to { visibility: visible}}
    @-o-keyframes -amp-start { from { visibility: hidden} to { visibility: visible}}
    @keyframes -amp-start { from { visibility: hidden} to { visibility: visible}}
  </style>
  <noscript><style amp-boilerplate>body { animation: none}</style></noscript>
  
    <style amp-custom>
      body { font-family: Arial, sans-serif; padding: 20px;}
.label { font-weight: bold; margin-top: 20px; display: block;}
      amp-selector div {
        padding: 10px; border: 1px solid #ccc; margin: 5px;
        cursor: pointer; display: inline-block;
}
      amp-selector [option][selected] {
        background: #007bff; color: white;
}
.price { font-size: 1.5em; color: #007bff; margin-top: 20px;}

textarea {
    width: 100%;
    padding: 10px;
    border: 3px solid #ccc;
    border-radius: 15px;
    font-size: 16px;
    resize: vertical;
    background-color: #f9f9f9;
    box-sizing: border-box;
    transition: border-color 0.3s ease;
}

  textarea:focus {
    border-color: #007bff;
    outline: none;
    background-color: #fff;
}

.label {
    font-weight: bold;
    margin-top: 20px;
    display: block;
  }  
    
    .default:after {
    content: '100$';
}

.amp-geo-group-eur .default:after {
    content: '90€ ';
}

.amp-geo-group-cad .default:after {
    content: '60CAD';
}

.amp-geo-group-aud .default:after {
    content: '80AUD';
}

.amp-geo-group-gbp .default:after {
    content: '70£';
 }
   .amp-geo-group-usd .default:after {
    content: '100$'; 
    
}
 


    </style>
  
  </head>
  <body>

<amp-geo layout="nodisplay">
  <script type="application/json">
    {
    "AmpBind": true,
      "ISOCountryGroups": {
        "eur": ["fr", "it", "bj", "nl", "at"],
        "cad": ["ca"],
        "aud": ["au"],
        "gbp": ["gb"],
        "usd": ["us"],
        "default": ["unknown"]
}
}
  </script>
</amp-geo>

<div>The game is called <span class="default"></span>!</div>
  <!-- Initialisation -->
  <amp-state id="formData">
    <script type="application/json">
      {
        "type": "article",
        "articles": 0,
        "currency": "",
        "basePrice": 0,
        "discountThreshold": 3,
        "discountRate": 0.15,
        "totalPrice": 0,
        "reduction": 0
}
    </script>
  </amp-state>
  
 <button on="tap:selectors.clear,selector.clear,selectorss.clear,AMP.setState({formData: {totalPrice: '',  reduction: '', articles: ''}})">essayer d'effacer</button>

  <form method="post" action-xhr="/commande" target="_top">

    <!-- Type de contenu -->
    <span class="label">Type de contenu:</span>
    <amp-selector id="selector"  name="type" layout="container"
      on="select:AMP.setState({formData: {type: event.targetOption}})">
      <div option="article" >Article</div>
      <div option="post">Post Réseaux Sociaux</div>
      <div option="script">Script Vidéo</div>
    </amp-selector>
    
    <span class="label"> Ecrivez votre texte à exécuter :</span>
    <textarea id="ta1" name="text" rows="6" placeholder="Écris ton message " required></textarea>

<!-- Nombre d’articles -->
    <span class="label">Nombre d’articles:</span>
    <amp-selector id="selectors"name="articles" layout="container"
      on="select:AMP.setState({
        formData: {
          articles: event.targetOption,
          reduction: (
            event.targetOption>= formData.discountThreshold?
            (formData.basePrice * event.targetOption * formData.discountRate): 0
).toFixed(2),
          totalPrice: (
            formData.basePrice * event.targetOption*
            (event.targetOption>= formData.discountThreshold? (1 - formData.discountRate): 1)
).toFixed(2)
}
})">
      <div option="1">1</div>
      <div option="2">2</div>
      <div option="3">3</div>
      <div option="4">4</div>
      <div option="5">5</div>
      <div option="6">6</div>
      <div option="7">7</div>
      
    </amp-selector>
    
    <span class="label">Ou entrez un nombre personnalisé:</span>
    <input "type="number"
  min="1"
  step="1"
  inputmode="numeric"
  pattern="[0-9]*"
  input-debounced
      on="input-debounced:AMP.setState({
        formData: {
          articles: event.value,
          reduction: (
            event.value>= formData.discountThreshold?
            (formData.basePrice * event.value * formData.discountRate): 0
).toFixed(2),
          totalPrice: (
            formData.basePrice * event.value*
            (event.value>= formData.discountThreshold? (1 - formData.discountRate): 1)
).toFixed(2)
}
})">

    
    <!-- Convertisseur de devise -->
    <span class="label">Choisissez votre devise:</span>
    <amp-selector  id="selectorss" name="currency" layout="container" 
  on="select:AMP.setState({
    formData: {
      currency: event.targetOption,
      basePrice: (
        event.targetOption == 'USD'? 100:
        event.targetOption == 'AUS'? 80:
        event.targetOption == 'CAD'? 95:
        event.targetOption == 'GBP'? 90:
        80
),
      reduction: (
        formData.articles>= formData.discountThreshold?
        (
          (event.targetOption == 'USD'? 100:
           event.targetOption == 'AUS'? 80:
           event.targetOption == 'CAD'? 95:
           event.targetOption == 'GBP'? 90:
           80) * formData.articles * formData.discountRate
): 0
).toFixed(2),
      totalPrice: (
        (event.targetOption == 'USD'? 100:
         event.targetOption == 'AUS'? 80:
         event.targetOption == 'CAD'? 95:
         event.targetOption == 'GBP'? 90:
         80) * formData.articles*
        (formData.articles>= formData.discountThreshold? (1 - formData.discountRate): 1)
).toFixed(2)
}
})" >
  <div option="EUR" >€ Euro</div>
  <div option="AUS">Dollars Australie</div>
  <div option="USD">$ Dollar US</div>
  <div option="CAD">CAD Dollar CA</div>
  <div option="GBP">£ Livre UK</div>
</amp-selector>
    
    
    <!-- Prix affiché -->
    <div class="price" [text]="'Prix total: ' + formData.totalPrice + ' ' + formData.currency">Prix total:0.00</div>
    <div [text]="'Réduction: -' + formData.reduction + ' ' + formData.currency">Réduction:0.00 </div>

    <!-- Champs cachés pour soumission -->
    <input type="hidden" name="type" [value]="formData.type">
    <input type="hidden" name="articles" [value]="formData.articles">
    <input type="hidden" name="prix" [value]="formData.totalPrice">
    <input type="hidden" name="reduction" [value]="formData.reduction">
    <input type="hidden" name="currency" [value]="formData.currency">

    
 <button type="submit">Commander</button>

    <!-- Message de succès -->
    <div submit-success>
      <template type="amp-mustache">
        Merci pour votre commande! Nous vous contacterons rapidement.
      </template>
    </div>

    <!-- Message d’erreur -->
    <div submit-error>
      <template type="amp-mustache">
        Une erreur est survenue. Veuillez réessayer.
      </template>
    </div>

  </form>
</body>
</html>
